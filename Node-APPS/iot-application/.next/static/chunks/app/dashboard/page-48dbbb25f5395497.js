(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5105],{10619:(e,t,s)=>{Promise.resolve().then(s.bind(s,17188))},17188:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>eD});var a=s(95155);class n{static getInstance(){return n.instance||(n.instance=new n),n.instance}startMetricsPolling(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500;this.stopMetricsPolling(),this.refreshRate=e,console.log("Starting system metrics polling with refresh rate: ".concat(e,"ms")),this.fetchMetrics(),this.refreshInterval=setInterval(()=>{this.fetchMetrics()},this.refreshRate)}stopMetricsPolling(){this.refreshInterval&&(console.log("Stopping system metrics polling"),clearInterval(this.refreshInterval),this.refreshInterval=null)}async fetchMetrics(){try{let e=await fetch("/api/system/metrics",{method:"GET",headers:{"Content-Type":"application/json"},cache:"no-store"});if(!e.ok)throw Error("Error fetching metrics: ".concat(e.status));let t=await e.json();t.success&&t.metrics&&(this.metrics=t.metrics,this.notifyListeners())}catch(e){console.error("Error fetching system metrics:",e)}}getMetrics(){return this.metrics}addListener(e){this.listeners.push(e)}removeListener(e){this.listeners=this.listeners.filter(t=>t!==e)}notifyListeners(){this.metrics&&this.listeners.forEach(e=>{try{e(this.metrics)}catch(e){console.error("Error in metrics listener:",e)}})}getRefreshRate(){return this.refreshRate}constructor(){this.metrics=null,this.refreshInterval=null,this.refreshRate=500,this.listeners=[],this.metrics={cpu:{usage:0},memory:{total:0,used:0,free:0},storage:{total:0,used:0,free:0},temperature:{cpu:0},uptime:{days:0,hours:0,minutes:0},services:[]}}}var r=s(12115),i=s(95880),l=s(73314),c=s(44992),o=s(90488);let d=i.A,u=e=>{let{children:t}=e;return(0,a.jsx)("div",{className:"rounded-lg border bg-card text-card-foreground shadow-sm",children:t})},m=e=>{let{className:t,children:s}=e;return(0,a.jsx)("div",{className:"flex flex-col space-y-1.5 p-6 ".concat(t||""),children:s})},h=e=>{let{children:t}=e;return(0,a.jsx)("h3",{className:"text-2xl font-semibold leading-none tracking-tight",children:t})},x=e=>{let{children:t}=e;return(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:t})},p=e=>{let{className:t,children:s}=e;return(0,a.jsx)("div",{className:"p-6 pt-0 ".concat(t||""),children:s})},v=e=>{let{value:t,className:s}=e;return(0,a.jsx)("div",{className:"relative h-4 w-full overflow-hidden rounded-full bg-secondary ".concat(s||""),children:(0,a.jsx)("div",{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(t||0),"%)")}})})},f=e=>{let{className:t,children:s}=e;return(0,a.jsx)("span",{className:"px-2 py-1 text-xs rounded-full ".concat(t||""),children:s})};function j(){let[e,t]=(0,r.useState)({cpu:{usage:0},memory:{total:0,used:0,free:0},storage:{total:0,used:0,free:0},temperature:{cpu:0},uptime:{days:0,hours:0,minutes:0}}),[s,j]=(0,r.useState)("healthy");(0,r.useEffect)(()=>{let e=n.getInstance(),s=e=>{t(e),e.cpu.usage>90||e.temperature.cpu>80?j("critical"):e.cpu.usage>70||e.temperature.cpu>70?j("warning"):j("healthy")};return e.addListener(s),e.startMetricsPolling(500),()=>{e.removeListener(s)}},[]);let g=e.memory.total/1024,b=e.memory.used/1024,y=e.memory.total>0?e.memory.used/e.memory.total*100:0,N=e.storage.total>0?e.storage.used/e.storage.total*100:0;return(0,a.jsxs)(u,{children:[(0,a.jsxs)(m,{className:"pb-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(h,{children:"System Status"}),(0,a.jsx)(f,{className:"healthy"===s?"bg-green-500":"warning"===s?"bg-amber-500":"bg-red-500",children:"healthy"===s?"Healthy":"warning"===s?"Warning":"Critical"})]}),(0,a.jsx)(x,{children:"CM4-IO-WIRELESS-BASE with Raspberry Pi CM4"})]}),(0,a.jsx)(p,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(l.A,{className:"h-4 w-4 text-blue-500"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"CPU Usage"})]}),(0,a.jsxs)("span",{className:"text-sm",children:[e.cpu.usage.toFixed(1),"%"]})]}),(0,a.jsx)(v,{value:e.cpu.usage,className:"h-2"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(d,{className:"h-4 w-4 text-purple-500"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Memory"})]}),(0,a.jsxs)("span",{className:"text-sm",children:[b.toFixed(1)," GB / ",g.toFixed(1)," GB"]})]}),(0,a.jsx)(v,{value:y,className:"h-2"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(i.A,{className:"h-4 w-4 text-amber-500"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Storage"})]}),(0,a.jsxs)("span",{className:"text-sm",children:[e.storage.used.toFixed(1)," GB / ",e.storage.total.toFixed(1)," GB"]})]}),(0,a.jsx)(v,{value:N,className:"h-2"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(c.A,{className:"h-4 w-4 text-red-500"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Temperature"})]}),(0,a.jsxs)("span",{className:"text-sm",children:[e.temperature.cpu,"\xb0C"]})]}),(0,a.jsx)(v,{value:e.temperature.cpu,max:100,className:"h-2"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between pt-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(o.A,{className:"h-4 w-4 text-green-500"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Uptime"})]}),(0,a.jsxs)("span",{className:"text-sm",children:[e.uptime.days,"d ",e.uptime.hours,"h ",e.uptime.minutes,"m"]})]})]})})]})}var g=s(88482),b=s(53904),y=s(76517),N=s(66306),w=s(19302),S=s(98611),A=s(88145),I=s(97168),D=s(53999);function T(e){let{className:t,...s}=e;return(0,a.jsx)("div",{className:(0,D.cn)("animate-pulse rounded-md bg-muted",t),...s})}var E=s(37777),M=s(53580);function C(){let{toast:e}=(0,M.d)(),[t,s]=(0,r.useState)(!0),[n,i]=(0,r.useState)(!1),[o,d]=(0,r.useState)(null),[u,m]=(0,r.useState)(null),h=async()=>{t||i(!0),m(null);try{let s=await fetch("/api/devices/count");if(!s.ok)throw Error("Error ".concat(s.status,": ").concat(s.statusText));let a=await s.json();d(a),!t&&n&&e({title:"Device counts refreshed",description:"Connected device information has been updated."})}catch(a){let s=a instanceof Error?a.message:"Failed to fetch device counts";m(s),t||e({title:"Refresh failed",description:s,variant:"destructive"})}finally{s(!1),i(!1)}};(0,r.useEffect)(()=>{h();let e=setInterval(h,6e4);return()=>clearInterval(e)},[]);let x=e=>{let{icon:s,label:n,count:r,color:i}=e;return(0,a.jsxs)(E.m_,{children:[(0,a.jsx)(E.k$,{asChild:!0,children:(0,a.jsxs)("div",{className:"flex items-center justify-between hover:bg-accent hover:text-accent-foreground p-2 rounded-lg",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(s,{className:"h-4 w-4 ".concat(i)}),(0,a.jsx)("span",{className:"text-sm font-medium",children:n})]}),t?(0,a.jsx)(T,{className:"h-5 w-12 rounded"}):(0,a.jsx)(A.E,{variant:r&&r>0?"outline":"secondary",children:void 0!==r?"".concat(r," device").concat(1!==r?"s":""):"Unknown"})]})}),(0,a.jsx)(E.ZI,{side:"right",children:(0,a.jsx)("p",{className:"text-xs",children:p(n,r)})})]})},p=(e,t)=>void 0===t?"Unable to detect ".concat(e," devices"):0===t?"No ".concat(e," devices detected"):1===t?"1 ".concat(e," device connected"):"".concat(t," ").concat(e," devices connected");return(0,a.jsxs)(g.Zp,{children:[(0,a.jsxs)(g.aR,{className:"flex flex-row items-center justify-between pb-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(g.ZB,{children:"Device Overview"}),(0,a.jsx)(g.BT,{children:"Connected devices by protocol"})]}),(0,a.jsxs)(I.$,{variant:"outline",size:"sm",onClick:h,disabled:t||n,children:[(0,a.jsx)(b.A,{className:"h-4 w-4 mr-1 ".concat(n?"animate-spin":"")}),n?"Refreshing":"Refresh"]})]}),(0,a.jsx)(g.Wu,{children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(x,{icon:y.A,label:"Wi-Fi",count:null==o?void 0:o.counts.wifi,color:"text-blue-500"}),(0,a.jsx)(x,{icon:N.A,label:"Bluetooth",count:null==o?void 0:o.counts.bluetooth,color:"text-indigo-500"}),(0,a.jsx)(x,{icon:w.A,label:"Ethernet",count:null==o?void 0:o.counts.ethernet,color:"text-green-500"}),(0,a.jsx)(x,{icon:l.A,label:"I2C",count:null==o?void 0:o.counts.i2c,color:"text-amber-500"}),(0,a.jsx)(x,{icon:S.A,label:"SPI",count:null==o?void 0:o.counts.spi,color:"text-red-500"}),(0,a.jsx)(x,{icon:c.A,label:"Sensors",count:null==o?void 0:o.counts.sensors,color:"text-purple-500"})]})})]})}var k=s(54213),O=s(79397),R=s(34869),U=s(25487),P=s(51154),B=s(75525),_=s(85339);let W=[{name:"can0-interface",description:"CAN0 Interface Setup",status:"unknown"},{name:"influxdb",description:"InfluxDB Time Series Database",status:"unknown"},{name:"mongod",description:"MongoDB Database Server",status:"unknown"},{name:"grafana-server",description:"Grafana Dashboard",status:"unknown"},{name:"nginx",description:"Web Server",status:"unknown"},{name:"webmin",description:"Webmin Administration",status:"unknown"}];function L(){var e;let{data:t,isLoading:s,error:n,refresh:i}=function(){let[e,t]=(0,r.useState)(null),[s,a]=(0,r.useState)(!0),[n,i]=(0,r.useState)(null),[l,c]=(0,r.useState)(new Date),o=async()=>{try{a(!0);let e=await fetch("/api/system/metrics");if(!e.ok)throw Error("Failed to fetch metrics: ".concat(e.statusText));let s=await e.json();t(s.metrics||s),i(null)}catch(e){console.error("Error fetching system metrics:",e),i(e)}finally{a(!1),c(new Date)}};return(0,r.useEffect)(()=>{o();let e=setInterval(o,1e4);return()=>{clearInterval(e)}},[]),{data:e,isLoading:s,error:n,lastUpdated:l,refresh:()=>{o()}}}(),[c,o]=(0,r.useState)(0),d=e=>{let t=e.toLowerCase();return t.includes("mongo")||t.includes("influx")?k.A:t.includes("grafana")?O.A:t.includes("nginx")?R.A:t.includes("webmin")?U.A:t.includes("spi")||t.includes("i2c")||t.includes("can")?l.A:U.A};(0,r.useEffect)(()=>{if(n||!(null==t?void 0:t.services)&&!s&&c<3){let e=setTimeout(()=>{i(),o(e=>e+1)},2e3);return()=>clearTimeout(e)}},[t,n,s,c,i]);let u=(null==t?void 0:null===(e=t.services)||void 0===e?void 0:e.length)>0?t.services:W;return(0,a.jsxs)(g.Zp,{className:"h-full",children:[(0,a.jsxs)(g.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(g.ZB,{className:"text-sm font-medium",children:"System Services"}),(0,a.jsxs)("div",{className:"flex items-center",children:[s&&(0,a.jsx)(P.A,{className:"h-3.5 w-3.5 text-muted-foreground animate-spin mr-2"}),(0,a.jsx)(B.A,{className:"h-4 w-4 text-muted-foreground"})]})]}),(0,a.jsx)(g.Wu,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[u.map(e=>{let t=d(e.name);return(0,a.jsxs)("div",{className:"flex items-center justify-between bg-background p-3 rounded-lg border",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(t,{className:"h-4 w-4 text-blue-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:e.name}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:e.description})]})]}),(0,a.jsx)(A.E,{className:"".concat("active"===e.status?"bg-green-500 hover:bg-green-600":"inactive"===e.status?"bg-gray-500 hover:bg-gray-600":"failed"===e.status?"bg-red-500 hover:bg-red-600":"activating"===e.status?"bg-blue-500 hover:bg-blue-600":"bg-amber-500 hover:bg-amber-600"),children:"active"===e.status?"Running":"activating"===e.status?"Activating":"inactive"===e.status?"Inactive":"failed"===e.status?"Failed":"Unknown"})]},e.name)}),n&&c>=3&&(0,a.jsx)("div",{className:"mt-4 p-2 bg-destructive/10 rounded-md",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 justify-center",children:[(0,a.jsx)(_.A,{className:"h-3.5 w-3.5 text-destructive"}),(0,a.jsx)("p",{className:"text-xs text-destructive text-center",children:(null==n?void 0:n.message)||"Connection error"})]})})]})})]})}var F=s(1243),Z=s(81284),z=s(16891);function $(){let e=[{id:1,title:"CAN0 Interface Down",description:"CAN0 interface is not responding",time:"10 minutes ago",severity:"high",icon:F.A,color:"text-red-500",badge:"bg-red-500"},{id:2,title:"Temperature Sensor Warning",description:"Temperature above threshold (42\xb0C)",time:"25 minutes ago",severity:"medium",icon:_.A,color:"text-amber-500",badge:"bg-amber-500"},{id:3,title:"New Device Connected",description:"Temperature sensor connected via I2C",time:"1 hour ago",severity:"info",icon:Z.A,color:"text-blue-500",badge:"bg-blue-500"},{id:4,title:"System Update Available",description:"New firmware update available",time:"3 hours ago",severity:"info",icon:Z.A,color:"text-blue-500",badge:"bg-blue-500"}];return(0,a.jsxs)(g.Zp,{children:[(0,a.jsxs)(g.aR,{className:"pb-2",children:[(0,a.jsx)(g.ZB,{children:"Recent Alerts"}),(0,a.jsx)(g.BT,{children:"Latest system and device alerts"})]}),(0,a.jsx)(g.Wu,{children:(0,a.jsx)(z.ScrollArea,{className:"h-[220px] pr-4",children:(0,a.jsx)("div",{className:"space-y-4",children:e.map(e=>(0,a.jsxs)("div",{className:"flex gap-3 pb-3 border-b last:border-0 last:pb-0",children:[(0,a.jsx)("div",{className:"mt-0.5 ".concat(e.color),children:(0,a.jsx)(e.icon,{className:"h-5 w-5"})}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h4",{className:"text-sm font-medium",children:e.title}),(0,a.jsx)(A.E,{className:e.badge,children:e.severity})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:e.description}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:e.time})]})]},e.id))})})})]})}function G(){return(0,a.jsxs)(g.Zp,{children:[(0,a.jsxs)(g.aR,{className:"pb-2",children:[(0,a.jsx)(g.ZB,{children:"Network Status"}),(0,a.jsx)(g.BT,{children:"Current network connections"})]}),(0,a.jsx)(g.Wu,{children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(y.A,{className:"h-4 w-4 text-blue-500"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Wi-Fi"})]}),(0,a.jsx)(A.E,{className:"bg-green-500",children:"Connected"})]}),(0,a.jsxs)("div",{className:"pl-6 text-xs text-muted-foreground space-y-1",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"SSID:"}),(0,a.jsx)("span",{children:"CM4_Network"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"IP:"}),(0,a.jsx)("span",{children:"192.168.1.105"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Signal:"}),(0,a.jsx)("span",{children:"-58 dBm"})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between pt-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(w.A,{className:"h-4 w-4 text-green-500"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Ethernet"})]}),(0,a.jsx)(A.E,{className:"bg-green-500",children:"Connected"})]}),(0,a.jsxs)("div",{className:"pl-6 text-xs text-muted-foreground space-y-1",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"IP:"}),(0,a.jsx)("span",{children:"192.168.1.100"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Speed:"}),(0,a.jsx)("span",{children:"1 Gbps"})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between pt-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(R.A,{className:"h-4 w-4 text-orange-500"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Internet"})]}),(0,a.jsx)(A.E,{className:"bg-green-500",children:"Connected"})]}),(0,a.jsxs)("div",{className:"pl-6 text-xs text-muted-foreground space-y-1",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Status:"}),(0,a.jsx)("span",{children:"Online"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Ping:"}),(0,a.jsx)("span",{children:"24 ms"})]})]})]})})]})}var K=s(35695),H=s(84616),V=s(91788),X=s(23861),Q=s(27265);class q{startMonitoring(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5e3;this.updateInterval&&clearInterval(this.updateInterval),this.updateInterval=setInterval(()=>{this.updateServiceStatus(),this.updateInterfaceStatus()},e),console.log("Service monitoring started with interval of ".concat(e,"ms"))}stopMonitoring(){this.updateInterval&&(clearInterval(this.updateInterval),this.updateInterval=null,console.log("Service monitoring stopped"))}getServiceStatus(e){return e?this.services.find(t=>t.name===e)||{name:e,status:"unknown",lastUpdated:Date.now()}:[...this.services]}getInterfaceStatus(e){return e?this.interfaces.find(t=>t.name===e)||{name:e,type:"gpio",status:"unknown",lastUpdated:Date.now()}:[...this.interfaces]}async restartService(e){return new Promise(t=>{let s=this.services.find(t=>t.name===e);if(!s){console.log("Service ".concat(e," not found")),t(!1);return}console.log("Restarting service ".concat(e,"...")),s.status="stopped",setTimeout(()=>{s.status="running",s.uptime=0,s.lastUpdated=Date.now(),console.log("Service ".concat(e," restarted successfully")),t(!0)},2e3)})}async enableInterface(e){return new Promise(t=>{let s=this.interfaces.find(t=>t.name===e);if(!s){console.log("Interface ".concat(e," not found")),t(!1);return}console.log("Enabling interface ".concat(e,"...")),setTimeout(()=>{s.status="active",s.lastUpdated=Date.now(),console.log("Interface ".concat(e," enabled successfully")),t(!0)},1e3)})}async disableInterface(e){return new Promise(t=>{let s=this.interfaces.find(t=>t.name===e);if(!s){console.log("Interface ".concat(e," not found")),t(!1);return}console.log("Disabling interface ".concat(e,"...")),setTimeout(()=>{s.status="inactive",s.lastUpdated=Date.now(),console.log("Interface ".concat(e," disabled successfully")),t(!0)},1e3)})}updateServiceStatus(){this.services.forEach(e=>{e.cpu=Math.max(.1,Math.min(100,e.cpu+(2*Math.random()-1))),e.memory=Math.max(10,Math.min(1024,e.memory+(10*Math.random()-5))),e.uptime+=5,Math.random()>.98&&(e.status="running"===e.status?"error":"running"),e.lastUpdated=Date.now()})}updateInterfaceStatus(){this.interfaces.forEach(e=>{Math.random()>.95&&(e.status="active"===e.status?"inactive":"active"),"i2c"===e.type&&e.details?e.details.devices=Math.floor(6*Math.random())+1:"spi"===e.type&&e.details&&(e.details.devices=Math.floor(3*Math.random())+1),e.lastUpdated=Date.now()})}constructor(){this.services=[],this.interfaces=[],this.updateInterval=null,this.services=[{name:"mongodb",status:"running",pid:1234,memory:256.5,cpu:2.3,uptime:86400,port:27017,lastUpdated:Date.now()},{name:"influxd",status:"running",pid:1235,memory:128.7,cpu:1.5,uptime:172800,port:8086,lastUpdated:Date.now()},{name:"grafana-server",status:"running",pid:1236,memory:98.2,cpu:.8,uptime:86400,port:3e3,lastUpdated:Date.now()},{name:"webmin",status:"running",pid:1237,memory:45.6,cpu:.2,uptime:259200,port:1e4,lastUpdated:Date.now()},{name:"nginx",status:"running",pid:1238,memory:32.1,cpu:.3,uptime:172800,port:80,lastUpdated:Date.now()}],this.interfaces=[{name:"SPI0",type:"spi",status:"active",details:{speed:"10 MHz",mode:0,devices:2},lastUpdated:Date.now()},{name:"I2C1",type:"i2c",status:"active",details:{speed:"400 kHz",devices:4},lastUpdated:Date.now()},{name:"CAN0",type:"can",status:"inactive",details:{bitrate:"500 kbit/s"},lastUpdated:Date.now()},{name:"UART0",type:"uart",status:"active",details:{baudrate:"115200",parity:"none",databits:8,stopbits:1},lastUpdated:Date.now()},{name:"GPIO",type:"gpio",status:"active",details:{pins:40,used:8},lastUpdated:Date.now()}]}}let J=null;function Y(){let e=(0,K.useRouter)(),{toast:t}=(0,M.d)(),[s,n]=(0,r.useState)(!1),[i,l]=(0,r.useState)(!1),[c,o]=(0,r.useState)(!1),[d,u]=(0,r.useState)(!1),m=async()=>{n(!0);try{await new Promise(e=>setTimeout(e,1e3)),e.refresh(),t({title:"Data Refreshed",description:"All dashboard data has been updated."})}catch(e){t({title:"Refresh Failed",description:"There was an error refreshing the data.",variant:"destructive"})}finally{n(!1)}},h=async()=>{l(!0);try{await new Promise(e=>setTimeout(e,1500));let e="\n[".concat(new Date().toISOString(),"] System started\n[").concat(new Date().toISOString(),"] MongoDB connected\n[").concat(new Date().toISOString(),"] InfluxDB connected\n[").concat(new Date().toISOString(),"] Grafana service running\n[").concat(new Date().toISOString(),"] Nginx service running\n[").concat(new Date().toISOString(),"] Webmin service running\n[").concat(new Date().toISOString(),"] SPI interface active\n[").concat(new Date().toISOString(),"] I2C interface active\n[").concat(new Date().toISOString(),"] CAN0 interface inactive\n[").concat(new Date().toISOString(),"] Temperature sensor reading: 42\xb0C\n[").concat(new Date().toISOString(),"] Pressure sensor reading: 1013.2 hPa\n[").concat(new Date().toISOString(),"] Flow sensor reading: 2.3 L/min\n[").concat(new Date().toISOString(),"] Smart Light Controller status: On (75%)\n[").concat(new Date().toISOString(),"] Motor Controller status: Off\n[").concat(new Date().toISOString(),"] Gateway Node status: Active\n[").concat(new Date().toISOString(),"] Bluetooth Beacon status: Connected\n      ").trim(),s=new Blob([e],{type:"text/plain"}),a=URL.createObjectURL(s),n=document.createElement("a");n.href=a,n.download="system-logs-".concat(new Date().toISOString().split("T")[0],".txt"),document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(a),t({title:"Logs Exported",description:"System logs have been exported successfully."})}catch(e){t({title:"Export Failed",description:"There was an error exporting the logs.",variant:"destructive"})}finally{l(!1)}},x=async()=>{o(!0);try{await new Promise(e=>setTimeout(e,1e3)),t({title:"Alerts Cleared",description:"All system alerts have been cleared."}),e.refresh()}catch(e){t({title:"Clear Failed",description:"There was an error clearing the alerts.",variant:"destructive"})}finally{o(!1)}},p=async()=>{u(!0);try{let s=(J||(J=new q).startMonitoring(),J);for(let e of(t({title:"Restarting Services",description:"Attempting to restart all system services..."}),["mongodb","influxd","grafana-server","nginx","webmin"]))await s.restartService(e),await new Promise(e=>setTimeout(e,500));t({title:"Services Restarted",description:"All system services have been restarted successfully."}),e.refresh()}catch(e){t({title:"Restart Failed",description:"There was an error restarting the services.",variant:"destructive"})}finally{u(!1)}};return(0,a.jsxs)(g.Zp,{children:[(0,a.jsxs)(g.aR,{className:"pb-2",children:[(0,a.jsx)(g.ZB,{children:"Quick Actions"}),(0,a.jsx)(g.BT,{children:"Common system operations"})]}),(0,a.jsx)(g.Wu,{children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)(I.$,{variant:"outline",size:"sm",className:"h-9 justify-start",onClick:()=>{e.push("/devices/add"),t({title:"Add Device",description:"Navigating to device creation page."})},children:[(0,a.jsx)(H.A,{className:"mr-2 h-4 w-4"}),"Add Device"]}),(0,a.jsxs)(I.$,{variant:"outline",size:"sm",className:"h-9 justify-start",onClick:m,disabled:s,children:[(0,a.jsx)(b.A,{className:"mr-2 h-4 w-4 ".concat(s?"animate-spin":"")}),"Refresh Data"]}),(0,a.jsxs)(I.$,{variant:"outline",size:"sm",className:"h-9 justify-start",onClick:h,disabled:i,children:[(0,a.jsx)(V.A,{className:"mr-2 h-4 w-4"}),i?"Exporting...":"Export Logs"]}),(0,a.jsxs)(I.$,{variant:"outline",size:"sm",className:"h-9 justify-start",onClick:x,disabled:c,children:[(0,a.jsx)(X.A,{className:"mr-2 h-4 w-4"}),c?"Clearing...":"Clear Alerts"]}),(0,a.jsxs)(I.$,{variant:"outline",size:"sm",className:"h-9 justify-start col-span-2",onClick:p,disabled:d,children:[(0,a.jsx)(Q.A,{className:"mr-2 h-4 w-4"}),d?"Restarting...":"Restart Services"]})]})})]})}var ee=s(49103);function et(){let e=(0,K.useRouter)(),{toast:t}=(0,M.d)(),[s,n]=(0,r.useState)(!1),i=async()=>{n(!0);try{await new Promise(e=>setTimeout(e,1e3)),e.refresh(),t({title:"Dashboard refreshed",description:"All dashboard data has been updated."})}catch(e){t({title:"Refresh failed",description:"There was an error refreshing the dashboard.",variant:"destructive"})}finally{n(!1)}};return(0,a.jsxs)("div",{className:"flex flex-col space-y-2 md:flex-row md:items-center md:justify-between md:space-y-0",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold tracking-tight",children:"Dashboard"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Overview of your CM4-IO-WIRELESS-BASE system and connected devices"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)(I.$,{variant:"outline",size:"sm",onClick:i,disabled:s,children:[(0,a.jsx)(b.A,{className:"mr-2 h-4 w-4 ".concat(s?"animate-spin":"")}),"Refresh"]}),(0,a.jsxs)(I.$,{onClick:()=>{e.push("/devices/add"),t({title:"Add Device",description:"Navigating to device creation page."})},children:[(0,a.jsx)(ee.A,{className:"mr-2 h-4 w-4"}),"Add Device"]})]})]})}var es=s(34964),ea=s(83540),en=s(93504),er=s(94754),ei=s(96025),el=s(16238),ec=s(94517),eo=s(21374),ed=s(99445),eu=s(62341),em=s(3401),eh=s(58227),ex=s(58700);let ep=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:24;return Array.from({length:e},(e,t)=>({time:"".concat((t%24).toString().padStart(2,"0"),":00"),temperature:Math.round((20+5*Math.sin(t/3)+2*Math.random())*10)/10,humidity:Math.round((50+15*Math.cos(t/3)+5*Math.random())*10)/10,pressure:Math.round((1010+10*Math.sin(t/6)+3*Math.random())*10)/10,cpu:Math.round((15+10*Math.sin(t/2)+5*Math.random())*10)/10,memory:Math.round((30+15*Math.cos(t/4)+10*Math.random())*10)/10}))},ev=ep(),ef=ep(),ej=ep(7).map((e,t)=>({...e,day:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"][t]}));function eg(){let[e,t]=(0,r.useState)("line");return(0,a.jsxs)(g.Zp,{className:"col-span-2",children:[(0,a.jsxs)(g.aR,{children:[(0,a.jsx)(g.ZB,{children:"System Metrics"}),(0,a.jsx)(g.BT,{children:"Performance metrics over time"})]}),(0,a.jsx)(g.Wu,{children:(0,a.jsxs)(es.tU,{defaultValue:"line",onValueChange:t,children:[(0,a.jsxs)(es.j7,{className:"mb-4",children:[(0,a.jsx)(es.Xi,{value:"line",children:"Line Chart"}),(0,a.jsx)(es.Xi,{value:"area",children:"Area Chart"}),(0,a.jsx)(es.Xi,{value:"bar",children:"Bar Chart"}),(0,a.jsx)(es.Xi,{value:"multi",children:"Multi-Line"})]}),(0,a.jsx)(es.av,{value:"line",className:"h-[300px]",children:(0,a.jsx)(ex.at,{config:{temperature:{label:"Temperature",color:"hsl(var(--chart-1))"}},children:(0,a.jsx)(ea.u,{width:"100%",height:"100%",children:(0,a.jsxs)(en.b,{data:ev,children:[(0,a.jsx)(er.d,{strokeDasharray:"3 3",vertical:!1}),(0,a.jsx)(ei.W,{dataKey:"time"}),(0,a.jsx)(el.h,{}),(0,a.jsx)(ec.m,{content:(0,a.jsx)(ex.Nt,{indicator:"line"})}),(0,a.jsx)(eo.N,{type:"monotone",dataKey:"temperature",stroke:"var(--color-temperature)",strokeWidth:2,dot:!1,activeDot:{r:6}})]})})})}),(0,a.jsx)(es.av,{value:"area",className:"h-[300px]",children:(0,a.jsx)(ex.at,{config:{humidity:{label:"Humidity",color:"hsl(var(--chart-2))"}},children:(0,a.jsx)(ea.u,{width:"100%",height:"100%",children:(0,a.jsxs)(ed.Q,{data:ef,children:[(0,a.jsx)(er.d,{strokeDasharray:"3 3",vertical:!1}),(0,a.jsx)(ei.W,{dataKey:"time"}),(0,a.jsx)(el.h,{}),(0,a.jsx)(ec.m,{content:(0,a.jsx)(ex.Nt,{indicator:"line"})}),(0,a.jsx)(eu.G,{type:"monotone",dataKey:"humidity",stroke:"var(--color-humidity)",fill:"var(--color-humidity)",fillOpacity:.2})]})})})}),(0,a.jsx)(es.av,{value:"bar",className:"h-[300px]",children:(0,a.jsx)(ex.at,{config:{cpu:{label:"CPU Usage",color:"hsl(var(--chart-3))"}},children:(0,a.jsx)(ea.u,{width:"100%",height:"100%",children:(0,a.jsxs)(em.E,{data:ej,children:[(0,a.jsx)(er.d,{strokeDasharray:"3 3",vertical:!1}),(0,a.jsx)(ei.W,{dataKey:"day"}),(0,a.jsx)(el.h,{}),(0,a.jsx)(ec.m,{content:(0,a.jsx)(ex.Nt,{indicator:"line"})}),(0,a.jsx)(eh.y,{dataKey:"cpu",fill:"var(--color-cpu)",radius:4})]})})})}),(0,a.jsx)(es.av,{value:"multi",className:"h-[300px]",children:(0,a.jsx)(ex.at,{config:{temperature:{label:"Temperature",color:"hsl(var(--chart-1))"},humidity:{label:"Humidity",color:"hsl(var(--chart-2))"},pressure:{label:"Pressure",color:"hsl(var(--chart-3))"}},children:(0,a.jsx)(ea.u,{width:"100%",height:"100%",children:(0,a.jsxs)(en.b,{data:ev,children:[(0,a.jsx)(er.d,{strokeDasharray:"3 3",vertical:!1}),(0,a.jsx)(ei.W,{dataKey:"time"}),(0,a.jsx)(el.h,{yAxisId:"left"}),(0,a.jsx)(el.h,{yAxisId:"right",orientation:"right"}),(0,a.jsx)(ec.m,{content:(0,a.jsx)(ex.Nt,{indicator:"line"})}),(0,a.jsx)(eo.N,{yAxisId:"left",type:"monotone",dataKey:"temperature",stroke:"var(--color-temperature)",strokeWidth:2,dot:!1}),(0,a.jsx)(eo.N,{yAxisId:"left",type:"monotone",dataKey:"humidity",stroke:"var(--color-humidity)",strokeWidth:2,dot:!1}),(0,a.jsx)(eo.N,{yAxisId:"right",type:"monotone",dataKey:"pressure",stroke:"var(--color-pressure)",strokeWidth:2,dot:!1})]})})})})]})})]})}var eb=s(14738),ey=s(79545),eN=s(14259),ew=s(53286),eS=s(94498),eA=s(40646);function eI(){var e,t,s;let{toast:n}=(0,M.d)(),[i,c]=(0,r.useState)(!1),[o,d]=(0,r.useState)(!0),[u,m]=(0,r.useState)(null),[h,x]=(0,r.useState)(null),p=async()=>{c(!0),x(null);try{let e=await fetch("/api/hardware/status");if(!e.ok)throw Error("Error ".concat(e.status,": ").concat(e.statusText));let t=await e.json();m(t),o?d(!1):n({title:"Hardware status refreshed",description:"Hardware status information has been updated."})}catch(t){let e=t instanceof Error?t.message:"Failed to fetch hardware status";x(e),o||n({title:"Refresh failed",description:e,variant:"destructive"})}finally{c(!1)}};(0,r.useEffect)(()=>{p();let e=setInterval(p,3e4);return()=>clearInterval(e)},[]);let v=e=>{let{available:t,label:s,icon:n,details:r}=e;return(0,a.jsx)(E.TooltipProvider,{children:(0,a.jsxs)(E.m_,{children:[(0,a.jsx)(E.k$,{asChild:!0,children:(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 rounded-lg border hover:bg-accent hover:text-accent-foreground",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(n,{className:"h-5 w-5 ".concat(t?"text-green-500":"text-red-500")}),(0,a.jsx)("span",{children:s})]}),r?(0,a.jsx)(A.E,{variant:t?"outline":"destructive",className:"ml-2",children:r}):(0,a.jsx)("div",{className:"h-2 w-2 rounded-full ".concat(t?"bg-green-500":"bg-red-500")})]})}),(0,a.jsxs)(E.ZI,{side:"right",className:"max-w-sm",children:[(0,a.jsx)("p",{children:t?"".concat(s," is available and working properly."):"".concat(s," is not available or not working properly.")}),r&&(0,a.jsx)("p",{className:"text-xs opacity-80 mt-1",children:r})]})]})})};return o?(0,a.jsxs)(g.Zp,{children:[(0,a.jsxs)(g.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(g.ZB,{className:"text-xl font-bold",children:"Hardware Status"}),(0,a.jsx)(g.BT,{children:"Raspberry Pi hardware interfaces"})]}),(0,a.jsxs)(I.$,{variant:"outline",size:"sm",disabled:!0,children:[(0,a.jsx)(b.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Loading"]})]}),(0,a.jsx)(g.Wu,{children:(0,a.jsx)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2 lg:grid-cols-3",children:Array(6).fill(0).map((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 rounded-lg border",children:[(0,a.jsx)(T,{className:"h-6 w-[120px]"}),(0,a.jsx)(T,{className:"h-4 w-4 rounded-full"})]},t))})})]}):(0,a.jsxs)(g.Zp,{children:[(0,a.jsxs)(g.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(g.ZB,{className:"text-xl font-bold",children:"Hardware Status"}),(0,a.jsx)(g.BT,{children:"Raspberry Pi hardware interfaces"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)(I.$,{variant:"outline",size:"sm",onClick:()=>{p()},disabled:i,children:[(0,a.jsx)(b.A,{className:"mr-2 h-4 w-4 ".concat(i?"animate-spin":"")}),"Refresh"]}),(0,a.jsx)(I.$,{variant:"outline",size:"icon",children:(0,a.jsx)(eb.A,{className:"h-4 w-4"})})]})]}),(0,a.jsx)(g.Wu,{children:h?(0,a.jsxs)("div",{className:"flex items-center justify-center p-6 text-red-500",children:[(0,a.jsx)(ey.A,{className:"h-5 w-5 mr-2"}),(0,a.jsxs)("span",{children:["Error loading hardware status: ",h]})]}):(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2 lg:grid-cols-3",children:[(0,a.jsx)(v,{available:(null==u?void 0:u.status.wifi.initialized)||!1,label:"Wi-Fi Module",icon:eN.A,details:(null==u?void 0:null===(e=u.status.wifi.status)||void 0===e?void 0:e.ipAddress)||""}),(0,a.jsx)(v,{available:(null==u?void 0:u.status.bluetooth.available)&&(null==u?void 0:u.status.bluetooth.powered)||!1,label:"Bluetooth Module",icon:N.A,details:(null==u?void 0:u.status.bluetooth.controllerName)||""}),(0,a.jsx)(v,{available:(null==u?void 0:u.status.can.initialized)||!1,label:"CAN Interface",icon:ew.A}),(0,a.jsx)(v,{available:(null==u?void 0:u.status.i2c.available)||!1,label:"I2C Buses",icon:eS.A,details:(null==u?void 0:null===(t=u.status.i2c.buses)||void 0===t?void 0:t.length)?"".concat(null==u?void 0:u.status.i2c.buses.length," bus(es)"):"None"}),(0,a.jsx)(v,{available:(null==u?void 0:u.status.spi.available)||!1,label:"SPI Interfaces",icon:l.A,details:(null==u?void 0:null===(s=u.status.spi.devices)||void 0===s?void 0:s.length)?"".concat(null==u?void 0:u.status.spi.devices.length," device(s)"):"None"}),(0,a.jsx)(v,{available:(null==u?void 0:u.status.mongodb.connected)||!1,label:"System Database",icon:eA.A}),(0,a.jsx)(v,{available:(null==u?void 0:u.status.influxdb.connected)||!1,label:"Time-Series DB",icon:eA.A}),(0,a.jsx)(v,{available:(null==u?void 0:u.status.grafana.connected)||!1,label:"Dashboard Service",icon:eA.A})]})})]})}function eD(){return(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsx)(et,{}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[(0,a.jsx)(j,{}),(0,a.jsx)(L,{}),(0,a.jsx)($,{})]}),(0,a.jsx)(eI,{}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsx)("div",{className:"lg:col-span-2",children:(0,a.jsx)(eg,{})}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(C,{}),(0,a.jsx)(G,{}),(0,a.jsx)(Y,{})]})]})]})}},37777:(e,t,s)=>{"use strict";s.d(t,{TooltipProvider:()=>l,ZI:()=>d,k$:()=>o,m_:()=>c});var a=s(95155),n=s(12115),r=s(35801),i=s(53999);let l=r.Kq,c=r.bL,o=r.l9,d=n.forwardRef((e,t)=>{let{className:s,sideOffset:n=4,...l}=e;return(0,a.jsx)(r.UC,{ref:t,sideOffset:n,className:(0,i.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...l})});d.displayName=r.UC.displayName},53580:(e,t,s)=>{"use strict";s.d(t,{d:()=>m});var a=s(12115);let n={ADD_TOAST:"ADD_TOAST",UPDATE_TOAST:"UPDATE_TOAST",DISMISS_TOAST:"DISMISS_TOAST",REMOVE_TOAST:"REMOVE_TOAST"},r=0,i=new Map,l=(e,t)=>{switch(t.type){case n.ADD_TOAST:return{...e,toasts:[t.toast,...e.toasts].slice(0,5)};case n.UPDATE_TOAST:return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case n.DISMISS_TOAST:{let{toastId:s}=t;if(s)i.has(s)&&(clearTimeout(i.get(s)),i.delete(s));else for(let[e,t]of i.entries())clearTimeout(t),i.delete(e);return{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case n.REMOVE_TOAST:if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},c=[],o={toasts:[]};function d(e){o=l(o,e),c.forEach(e=>{e(o)})}function u(e){let{...t}=e,s=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>d({type:n.DISMISS_TOAST,toastId:s});return d({type:n.ADD_TOAST,toast:{...t,id:s,open:!0,onOpenChange:e=>{e||a()}}}),{id:s,dismiss:a,update:e=>d({type:n.UPDATE_TOAST,toast:{...e,id:s}})}}function m(){let[e,t]=a.useState(o);return a.useEffect(()=>(c.push(t),()=>{let e=c.indexOf(t);e>-1&&c.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>d({type:n.DISMISS_TOAST,toastId:e})}}},88145:(e,t,s)=>{"use strict";s.d(t,{E:()=>l});var a=s(95155);s(12115);var n=s(74466),r=s(53999);let i=(0,n.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:t,variant:s,...n}=e;return(0,a.jsx)("div",{className:(0,r.cn)(i({variant:s}),t),...n})}}},e=>{var t=t=>e(e.s=t);e.O(0,[5393,5152,8577,7658,8507,941,5045,4363,8441,1684,7358],()=>t(10619)),_N_E=e.O()}]);