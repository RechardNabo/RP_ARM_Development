(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5105],{10619:(e,s,t)=>{Promise.resolve().then(t.bind(t,17188))},17188:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>eD});var a=t(95155);class i{static getInstance(){return i.instance||(i.instance=new i),i.instance}startMetricsPolling(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500;this.stopMetricsPolling(),this.refreshRate=e,console.log("Starting system metrics polling with refresh rate: ".concat(e,"ms")),this.fetchMetrics(),this.refreshInterval=setInterval(()=>{this.fetchMetrics()},this.refreshRate)}stopMetricsPolling(){this.refreshInterval&&(console.log("Stopping system metrics polling"),clearInterval(this.refreshInterval),this.refreshInterval=null)}async fetchMetrics(){try{let e=await fetch("/api/system/metrics",{method:"GET",headers:{"Content-Type":"application/json"},cache:"no-store"});if(!e.ok)throw Error("Error fetching metrics: ".concat(e.status));let s=await e.json();s.success&&s.metrics&&(this.metrics=s.metrics,this.notifyListeners())}catch(e){console.error("Error fetching system metrics:",e)}}getMetrics(){return this.metrics}addListener(e){this.listeners.push(e)}removeListener(e){this.listeners=this.listeners.filter(s=>s!==e)}notifyListeners(){this.metrics&&this.listeners.forEach(e=>{try{e(this.metrics)}catch(e){console.error("Error in metrics listener:",e)}})}getRefreshRate(){return this.refreshRate}constructor(){this.metrics=null,this.refreshInterval=null,this.refreshRate=500,this.listeners=[],this.metrics={cpu:{usage:0},memory:{total:0,used:0,free:0},storage:{total:0,used:0,free:0},temperature:{cpu:0},uptime:{days:0,hours:0,minutes:0},services:[]}}}var r=t(12115),n=t(95880),l=t(73314),c=t(44992),d=t(90488);let o=n.A,m=e=>{let{children:s}=e;return(0,a.jsx)("div",{className:"rounded-lg border bg-card text-card-foreground shadow-sm",children:s})},u=e=>{let{className:s,children:t}=e;return(0,a.jsx)("div",{className:"flex flex-col space-y-1.5 p-6 ".concat(s||""),children:t})},h=e=>{let{children:s}=e;return(0,a.jsx)("h3",{className:"text-2xl font-semibold leading-none tracking-tight",children:s})},x=e=>{let{children:s}=e;return(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:s})},p=e=>{let{className:s,children:t}=e;return(0,a.jsx)("div",{className:"p-6 pt-0 ".concat(s||""),children:t})},f=e=>{let{value:s,className:t}=e;return(0,a.jsx)("div",{className:"relative h-4 w-full overflow-hidden rounded-full bg-secondary ".concat(t||""),children:(0,a.jsx)("div",{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(s||0),"%)")}})})},v=e=>{let{className:s,children:t}=e;return(0,a.jsx)("span",{className:"px-2 py-1 text-xs rounded-full ".concat(s||""),children:t})};function j(){let[e,s]=(0,r.useState)({cpu:{usage:0},memory:{total:0,used:0,free:0},storage:{total:0,used:0,free:0},temperature:{cpu:0},uptime:{days:0,hours:0,minutes:0}}),[t,j]=(0,r.useState)("healthy");(0,r.useEffect)(()=>{let e=i.getInstance(),t=e=>{s(e),e.cpu.usage>90||e.temperature.cpu>80?j("critical"):e.cpu.usage>70||e.temperature.cpu>70?j("warning"):j("healthy")};return e.addListener(t),e.startMetricsPolling(500),()=>{e.removeListener(t)}},[]);let g=e.memory.total/1024,y=e.memory.used/1024,b=e.memory.total>0?e.memory.used/e.memory.total*100:0,N=e.storage.total>0?e.storage.used/e.storage.total*100:0;return(0,a.jsxs)(m,{children:[(0,a.jsxs)(u,{className:"pb-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(h,{children:"System Status"}),(0,a.jsx)(v,{className:"healthy"===t?"bg-green-500":"warning"===t?"bg-amber-500":"bg-red-500",children:"healthy"===t?"Healthy":"warning"===t?"Warning":"Critical"})]}),(0,a.jsx)(x,{children:"CM4-IO-WIRELESS-BASE with Raspberry Pi CM4"})]}),(0,a.jsx)(p,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(l.A,{className:"h-4 w-4 text-blue-500"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"CPU Usage"})]}),(0,a.jsxs)("span",{className:"text-sm",children:[e.cpu.usage.toFixed(1),"%"]})]}),(0,a.jsx)(f,{value:e.cpu.usage,className:"h-2"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(o,{className:"h-4 w-4 text-purple-500"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Memory"})]}),(0,a.jsxs)("span",{className:"text-sm",children:[y.toFixed(1)," GB / ",g.toFixed(1)," GB"]})]}),(0,a.jsx)(f,{value:b,className:"h-2"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(n.A,{className:"h-4 w-4 text-amber-500"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Storage"})]}),(0,a.jsxs)("span",{className:"text-sm",children:[e.storage.used.toFixed(1)," GB / ",e.storage.total.toFixed(1)," GB"]})]}),(0,a.jsx)(f,{value:N,className:"h-2"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(c.A,{className:"h-4 w-4 text-red-500"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Temperature"})]}),(0,a.jsxs)("span",{className:"text-sm",children:[e.temperature.cpu,"\xb0C"]})]}),(0,a.jsx)(f,{value:e.temperature.cpu,max:100,className:"h-2"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between pt-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(d.A,{className:"h-4 w-4 text-green-500"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Uptime"})]}),(0,a.jsxs)("span",{className:"text-sm",children:[e.uptime.days,"d ",e.uptime.hours,"h ",e.uptime.minutes,"m"]})]})]})})]})}var g=t(88482),y=t(76517),b=t(66306),N=t(19302),w=t(98611);function S(){return(0,a.jsxs)(g.Zp,{children:[(0,a.jsxs)(g.aR,{className:"pb-2",children:[(0,a.jsx)(g.ZB,{children:"Device Overview"}),(0,a.jsx)(g.BT,{children:"Connected devices by protocol"})]}),(0,a.jsx)(g.Wu,{children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(y.A,{className:"h-4 w-4 text-blue-500"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Wi-Fi"})]}),(0,a.jsx)("span",{className:"text-sm",children:"5 devices"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(b.A,{className:"h-4 w-4 text-indigo-500"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Bluetooth"})]}),(0,a.jsx)("span",{className:"text-sm",children:"3 devices"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(N.A,{className:"h-4 w-4 text-green-500"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Ethernet"})]}),(0,a.jsx)("span",{className:"text-sm",children:"2 devices"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(l.A,{className:"h-4 w-4 text-amber-500"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"I2C"})]}),(0,a.jsx)("span",{className:"text-sm",children:"4 devices"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(w.A,{className:"h-4 w-4 text-red-500"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"SPI"})]}),(0,a.jsx)("span",{className:"text-sm",children:"2 devices"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(c.A,{className:"h-4 w-4 text-purple-500"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Sensors"})]}),(0,a.jsx)("span",{className:"text-sm",children:"8 devices"})]})]})})]})}var A=t(88145),I=t(54213),D=t(79397),T=t(34869),M=t(25487),C=t(51154),E=t(75525),k=t(85339);let O=[{name:"can0-interface",description:"CAN0 Interface Setup",status:"unknown"},{name:"influxdb",description:"InfluxDB Time Series Database",status:"unknown"},{name:"mongod",description:"MongoDB Database Server",status:"unknown"},{name:"grafana-server",description:"Grafana Dashboard",status:"unknown"},{name:"nginx",description:"Web Server",status:"unknown"},{name:"webmin",description:"Webmin Administration",status:"unknown"}];function R(){var e;let{data:s,isLoading:t,error:i,refresh:n}=function(){let[e,s]=(0,r.useState)(null),[t,a]=(0,r.useState)(!0),[i,n]=(0,r.useState)(null),[l,c]=(0,r.useState)(new Date),d=async()=>{try{a(!0);let e=await fetch("/api/system/metrics");if(!e.ok)throw Error("Failed to fetch metrics: ".concat(e.statusText));let t=await e.json();s(t.metrics||t),n(null)}catch(e){console.error("Error fetching system metrics:",e),n(e)}finally{a(!1),c(new Date)}};return(0,r.useEffect)(()=>{d();let e=setInterval(d,1e4);return()=>{clearInterval(e)}},[]),{data:e,isLoading:t,error:i,lastUpdated:l,refresh:()=>{d()}}}(),[c,d]=(0,r.useState)(0),o=e=>{let s=e.toLowerCase();return s.includes("mongo")||s.includes("influx")?I.A:s.includes("grafana")?D.A:s.includes("nginx")?T.A:s.includes("webmin")?M.A:s.includes("spi")||s.includes("i2c")||s.includes("can")?l.A:M.A};(0,r.useEffect)(()=>{if(i||!(null==s?void 0:s.services)&&!t&&c<3){let e=setTimeout(()=>{n(),d(e=>e+1)},2e3);return()=>clearTimeout(e)}},[s,i,t,c,n]);let m=(null==s?void 0:null===(e=s.services)||void 0===e?void 0:e.length)>0?s.services:O;return(0,a.jsxs)(g.Zp,{className:"h-full",children:[(0,a.jsxs)(g.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsx)(g.ZB,{className:"text-sm font-medium",children:"System Services"}),(0,a.jsxs)("div",{className:"flex items-center",children:[t&&(0,a.jsx)(C.A,{className:"h-3.5 w-3.5 text-muted-foreground animate-spin mr-2"}),(0,a.jsx)(E.A,{className:"h-4 w-4 text-muted-foreground"})]})]}),(0,a.jsx)(g.Wu,{children:(0,a.jsxs)("div",{className:"space-y-4",children:[m.map(e=>{let s=o(e.name);return(0,a.jsxs)("div",{className:"flex items-center justify-between bg-background p-3 rounded-lg border",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(s,{className:"h-4 w-4 text-blue-400"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:e.name}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:e.description})]})]}),(0,a.jsx)(A.E,{className:"".concat("active"===e.status?"bg-green-500 hover:bg-green-600":"inactive"===e.status?"bg-gray-500 hover:bg-gray-600":"failed"===e.status?"bg-red-500 hover:bg-red-600":"activating"===e.status?"bg-blue-500 hover:bg-blue-600":"bg-amber-500 hover:bg-amber-600"),children:"active"===e.status?"Running":"activating"===e.status?"Activating":"inactive"===e.status?"Inactive":"failed"===e.status?"Failed":"Unknown"})]},e.name)}),i&&c>=3&&(0,a.jsx)("div",{className:"mt-4 p-2 bg-destructive/10 rounded-md",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 justify-center",children:[(0,a.jsx)(k.A,{className:"h-3.5 w-3.5 text-destructive"}),(0,a.jsx)("p",{className:"text-xs text-destructive text-center",children:(null==i?void 0:i.message)||"Connection error"})]})})]})})]})}var U=t(1243),B=t(81284),P=t(16891);function W(){let e=[{id:1,title:"CAN0 Interface Down",description:"CAN0 interface is not responding",time:"10 minutes ago",severity:"high",icon:U.A,color:"text-red-500",badge:"bg-red-500"},{id:2,title:"Temperature Sensor Warning",description:"Temperature above threshold (42\xb0C)",time:"25 minutes ago",severity:"medium",icon:k.A,color:"text-amber-500",badge:"bg-amber-500"},{id:3,title:"New Device Connected",description:"Temperature sensor connected via I2C",time:"1 hour ago",severity:"info",icon:B.A,color:"text-blue-500",badge:"bg-blue-500"},{id:4,title:"System Update Available",description:"New firmware update available",time:"3 hours ago",severity:"info",icon:B.A,color:"text-blue-500",badge:"bg-blue-500"}];return(0,a.jsxs)(g.Zp,{children:[(0,a.jsxs)(g.aR,{className:"pb-2",children:[(0,a.jsx)(g.ZB,{children:"Recent Alerts"}),(0,a.jsx)(g.BT,{children:"Latest system and device alerts"})]}),(0,a.jsx)(g.Wu,{children:(0,a.jsx)(P.ScrollArea,{className:"h-[220px] pr-4",children:(0,a.jsx)("div",{className:"space-y-4",children:e.map(e=>(0,a.jsxs)("div",{className:"flex gap-3 pb-3 border-b last:border-0 last:pb-0",children:[(0,a.jsx)("div",{className:"mt-0.5 ".concat(e.color),children:(0,a.jsx)(e.icon,{className:"h-5 w-5"})}),(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h4",{className:"text-sm font-medium",children:e.title}),(0,a.jsx)(A.E,{className:e.badge,children:e.severity})]}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:e.description}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:e.time})]})]},e.id))})})})]})}function _(){return(0,a.jsxs)(g.Zp,{children:[(0,a.jsxs)(g.aR,{className:"pb-2",children:[(0,a.jsx)(g.ZB,{children:"Network Status"}),(0,a.jsx)(g.BT,{children:"Current network connections"})]}),(0,a.jsx)(g.Wu,{children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(y.A,{className:"h-4 w-4 text-blue-500"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Wi-Fi"})]}),(0,a.jsx)(A.E,{className:"bg-green-500",children:"Connected"})]}),(0,a.jsxs)("div",{className:"pl-6 text-xs text-muted-foreground space-y-1",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"SSID:"}),(0,a.jsx)("span",{children:"CM4_Network"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"IP:"}),(0,a.jsx)("span",{children:"192.168.1.105"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Signal:"}),(0,a.jsx)("span",{children:"-58 dBm"})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between pt-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(N.A,{className:"h-4 w-4 text-green-500"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Ethernet"})]}),(0,a.jsx)(A.E,{className:"bg-green-500",children:"Connected"})]}),(0,a.jsxs)("div",{className:"pl-6 text-xs text-muted-foreground space-y-1",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"IP:"}),(0,a.jsx)("span",{children:"192.168.1.100"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Speed:"}),(0,a.jsx)("span",{children:"1 Gbps"})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between pt-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(T.A,{className:"h-4 w-4 text-orange-500"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:"Internet"})]}),(0,a.jsx)(A.E,{className:"bg-green-500",children:"Connected"})]}),(0,a.jsxs)("div",{className:"pl-6 text-xs text-muted-foreground space-y-1",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Status:"}),(0,a.jsx)("span",{children:"Online"})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Ping:"}),(0,a.jsx)("span",{children:"24 ms"})]})]})]})})]})}var L=t(35695),F=t(97168),Z=t(84616),z=t(53904),G=t(91788),$=t(23861),K=t(27265),H=t(53580);class V{startMonitoring(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5e3;this.updateInterval&&clearInterval(this.updateInterval),this.updateInterval=setInterval(()=>{this.updateServiceStatus(),this.updateInterfaceStatus()},e),console.log("Service monitoring started with interval of ".concat(e,"ms"))}stopMonitoring(){this.updateInterval&&(clearInterval(this.updateInterval),this.updateInterval=null,console.log("Service monitoring stopped"))}getServiceStatus(e){return e?this.services.find(s=>s.name===e)||{name:e,status:"unknown",lastUpdated:Date.now()}:[...this.services]}getInterfaceStatus(e){return e?this.interfaces.find(s=>s.name===e)||{name:e,type:"gpio",status:"unknown",lastUpdated:Date.now()}:[...this.interfaces]}async restartService(e){return new Promise(s=>{let t=this.services.find(s=>s.name===e);if(!t){console.log("Service ".concat(e," not found")),s(!1);return}console.log("Restarting service ".concat(e,"...")),t.status="stopped",setTimeout(()=>{t.status="running",t.uptime=0,t.lastUpdated=Date.now(),console.log("Service ".concat(e," restarted successfully")),s(!0)},2e3)})}async enableInterface(e){return new Promise(s=>{let t=this.interfaces.find(s=>s.name===e);if(!t){console.log("Interface ".concat(e," not found")),s(!1);return}console.log("Enabling interface ".concat(e,"...")),setTimeout(()=>{t.status="active",t.lastUpdated=Date.now(),console.log("Interface ".concat(e," enabled successfully")),s(!0)},1e3)})}async disableInterface(e){return new Promise(s=>{let t=this.interfaces.find(s=>s.name===e);if(!t){console.log("Interface ".concat(e," not found")),s(!1);return}console.log("Disabling interface ".concat(e,"...")),setTimeout(()=>{t.status="inactive",t.lastUpdated=Date.now(),console.log("Interface ".concat(e," disabled successfully")),s(!0)},1e3)})}updateServiceStatus(){this.services.forEach(e=>{e.cpu=Math.max(.1,Math.min(100,e.cpu+(2*Math.random()-1))),e.memory=Math.max(10,Math.min(1024,e.memory+(10*Math.random()-5))),e.uptime+=5,Math.random()>.98&&(e.status="running"===e.status?"error":"running"),e.lastUpdated=Date.now()})}updateInterfaceStatus(){this.interfaces.forEach(e=>{Math.random()>.95&&(e.status="active"===e.status?"inactive":"active"),"i2c"===e.type&&e.details?e.details.devices=Math.floor(6*Math.random())+1:"spi"===e.type&&e.details&&(e.details.devices=Math.floor(3*Math.random())+1),e.lastUpdated=Date.now()})}constructor(){this.services=[],this.interfaces=[],this.updateInterval=null,this.services=[{name:"mongodb",status:"running",pid:1234,memory:256.5,cpu:2.3,uptime:86400,port:27017,lastUpdated:Date.now()},{name:"influxd",status:"running",pid:1235,memory:128.7,cpu:1.5,uptime:172800,port:8086,lastUpdated:Date.now()},{name:"grafana-server",status:"running",pid:1236,memory:98.2,cpu:.8,uptime:86400,port:3e3,lastUpdated:Date.now()},{name:"webmin",status:"running",pid:1237,memory:45.6,cpu:.2,uptime:259200,port:1e4,lastUpdated:Date.now()},{name:"nginx",status:"running",pid:1238,memory:32.1,cpu:.3,uptime:172800,port:80,lastUpdated:Date.now()}],this.interfaces=[{name:"SPI0",type:"spi",status:"active",details:{speed:"10 MHz",mode:0,devices:2},lastUpdated:Date.now()},{name:"I2C1",type:"i2c",status:"active",details:{speed:"400 kHz",devices:4},lastUpdated:Date.now()},{name:"CAN0",type:"can",status:"inactive",details:{bitrate:"500 kbit/s"},lastUpdated:Date.now()},{name:"UART0",type:"uart",status:"active",details:{baudrate:"115200",parity:"none",databits:8,stopbits:1},lastUpdated:Date.now()},{name:"GPIO",type:"gpio",status:"active",details:{pins:40,used:8},lastUpdated:Date.now()}]}}let X=null;function Q(){let e=(0,L.useRouter)(),{toast:s}=(0,H.d)(),[t,i]=(0,r.useState)(!1),[n,l]=(0,r.useState)(!1),[c,d]=(0,r.useState)(!1),[o,m]=(0,r.useState)(!1),u=async()=>{i(!0);try{await new Promise(e=>setTimeout(e,1e3)),e.refresh(),s({title:"Data Refreshed",description:"All dashboard data has been updated."})}catch(e){s({title:"Refresh Failed",description:"There was an error refreshing the data.",variant:"destructive"})}finally{i(!1)}},h=async()=>{l(!0);try{await new Promise(e=>setTimeout(e,1500));let e="\n[".concat(new Date().toISOString(),"] System started\n[").concat(new Date().toISOString(),"] MongoDB connected\n[").concat(new Date().toISOString(),"] InfluxDB connected\n[").concat(new Date().toISOString(),"] Grafana service running\n[").concat(new Date().toISOString(),"] Nginx service running\n[").concat(new Date().toISOString(),"] Webmin service running\n[").concat(new Date().toISOString(),"] SPI interface active\n[").concat(new Date().toISOString(),"] I2C interface active\n[").concat(new Date().toISOString(),"] CAN0 interface inactive\n[").concat(new Date().toISOString(),"] Temperature sensor reading: 42\xb0C\n[").concat(new Date().toISOString(),"] Pressure sensor reading: 1013.2 hPa\n[").concat(new Date().toISOString(),"] Flow sensor reading: 2.3 L/min\n[").concat(new Date().toISOString(),"] Smart Light Controller status: On (75%)\n[").concat(new Date().toISOString(),"] Motor Controller status: Off\n[").concat(new Date().toISOString(),"] Gateway Node status: Active\n[").concat(new Date().toISOString(),"] Bluetooth Beacon status: Connected\n      ").trim(),t=new Blob([e],{type:"text/plain"}),a=URL.createObjectURL(t),i=document.createElement("a");i.href=a,i.download="system-logs-".concat(new Date().toISOString().split("T")[0],".txt"),document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(a),s({title:"Logs Exported",description:"System logs have been exported successfully."})}catch(e){s({title:"Export Failed",description:"There was an error exporting the logs.",variant:"destructive"})}finally{l(!1)}},x=async()=>{d(!0);try{await new Promise(e=>setTimeout(e,1e3)),s({title:"Alerts Cleared",description:"All system alerts have been cleared."}),e.refresh()}catch(e){s({title:"Clear Failed",description:"There was an error clearing the alerts.",variant:"destructive"})}finally{d(!1)}},p=async()=>{m(!0);try{let t=(X||(X=new V).startMonitoring(),X);for(let e of(s({title:"Restarting Services",description:"Attempting to restart all system services..."}),["mongodb","influxd","grafana-server","nginx","webmin"]))await t.restartService(e),await new Promise(e=>setTimeout(e,500));s({title:"Services Restarted",description:"All system services have been restarted successfully."}),e.refresh()}catch(e){s({title:"Restart Failed",description:"There was an error restarting the services.",variant:"destructive"})}finally{m(!1)}};return(0,a.jsxs)(g.Zp,{children:[(0,a.jsxs)(g.aR,{className:"pb-2",children:[(0,a.jsx)(g.ZB,{children:"Quick Actions"}),(0,a.jsx)(g.BT,{children:"Common system operations"})]}),(0,a.jsx)(g.Wu,{children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsxs)(F.$,{variant:"outline",size:"sm",className:"h-9 justify-start",onClick:()=>{e.push("/devices/add"),s({title:"Add Device",description:"Navigating to device creation page."})},children:[(0,a.jsx)(Z.A,{className:"mr-2 h-4 w-4"}),"Add Device"]}),(0,a.jsxs)(F.$,{variant:"outline",size:"sm",className:"h-9 justify-start",onClick:u,disabled:t,children:[(0,a.jsx)(z.A,{className:"mr-2 h-4 w-4 ".concat(t?"animate-spin":"")}),"Refresh Data"]}),(0,a.jsxs)(F.$,{variant:"outline",size:"sm",className:"h-9 justify-start",onClick:h,disabled:n,children:[(0,a.jsx)(G.A,{className:"mr-2 h-4 w-4"}),n?"Exporting...":"Export Logs"]}),(0,a.jsxs)(F.$,{variant:"outline",size:"sm",className:"h-9 justify-start",onClick:x,disabled:c,children:[(0,a.jsx)($.A,{className:"mr-2 h-4 w-4"}),c?"Clearing...":"Clear Alerts"]}),(0,a.jsxs)(F.$,{variant:"outline",size:"sm",className:"h-9 justify-start col-span-2",onClick:p,disabled:o,children:[(0,a.jsx)(K.A,{className:"mr-2 h-4 w-4"}),o?"Restarting...":"Restart Services"]})]})})]})}var q=t(49103);function J(){let e=(0,L.useRouter)(),{toast:s}=(0,H.d)(),[t,i]=(0,r.useState)(!1),n=async()=>{i(!0);try{await new Promise(e=>setTimeout(e,1e3)),e.refresh(),s({title:"Dashboard refreshed",description:"All dashboard data has been updated."})}catch(e){s({title:"Refresh failed",description:"There was an error refreshing the dashboard.",variant:"destructive"})}finally{i(!1)}};return(0,a.jsxs)("div",{className:"flex flex-col space-y-2 md:flex-row md:items-center md:justify-between md:space-y-0",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold tracking-tight",children:"Dashboard"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Overview of your CM4-IO-WIRELESS-BASE system and connected devices"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)(F.$,{variant:"outline",size:"sm",onClick:n,disabled:t,children:[(0,a.jsx)(z.A,{className:"mr-2 h-4 w-4 ".concat(t?"animate-spin":"")}),"Refresh"]}),(0,a.jsxs)(F.$,{onClick:()=>{e.push("/devices/add"),s({title:"Add Device",description:"Navigating to device creation page."})},children:[(0,a.jsx)(q.A,{className:"mr-2 h-4 w-4"}),"Add Device"]})]})]})}var Y=t(34964),ee=t(83540),es=t(93504),et=t(94754),ea=t(96025),ei=t(16238),er=t(94517),en=t(21374),el=t(99445),ec=t(62341),ed=t(3401),eo=t(58227),em=t(58700);let eu=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:24;return Array.from({length:e},(e,s)=>({time:"".concat((s%24).toString().padStart(2,"0"),":00"),temperature:Math.round((20+5*Math.sin(s/3)+2*Math.random())*10)/10,humidity:Math.round((50+15*Math.cos(s/3)+5*Math.random())*10)/10,pressure:Math.round((1010+10*Math.sin(s/6)+3*Math.random())*10)/10,cpu:Math.round((15+10*Math.sin(s/2)+5*Math.random())*10)/10,memory:Math.round((30+15*Math.cos(s/4)+10*Math.random())*10)/10}))},eh=eu(),ex=eu(),ep=eu(7).map((e,s)=>({...e,day:["Mon","Tue","Wed","Thu","Fri","Sat","Sun"][s]}));function ef(){let[e,s]=(0,r.useState)("line");return(0,a.jsxs)(g.Zp,{className:"col-span-2",children:[(0,a.jsxs)(g.aR,{children:[(0,a.jsx)(g.ZB,{children:"System Metrics"}),(0,a.jsx)(g.BT,{children:"Performance metrics over time"})]}),(0,a.jsx)(g.Wu,{children:(0,a.jsxs)(Y.tU,{defaultValue:"line",onValueChange:s,children:[(0,a.jsxs)(Y.j7,{className:"mb-4",children:[(0,a.jsx)(Y.Xi,{value:"line",children:"Line Chart"}),(0,a.jsx)(Y.Xi,{value:"area",children:"Area Chart"}),(0,a.jsx)(Y.Xi,{value:"bar",children:"Bar Chart"}),(0,a.jsx)(Y.Xi,{value:"multi",children:"Multi-Line"})]}),(0,a.jsx)(Y.av,{value:"line",className:"h-[300px]",children:(0,a.jsx)(em.at,{config:{temperature:{label:"Temperature",color:"hsl(var(--chart-1))"}},children:(0,a.jsx)(ee.u,{width:"100%",height:"100%",children:(0,a.jsxs)(es.b,{data:eh,children:[(0,a.jsx)(et.d,{strokeDasharray:"3 3",vertical:!1}),(0,a.jsx)(ea.W,{dataKey:"time"}),(0,a.jsx)(ei.h,{}),(0,a.jsx)(er.m,{content:(0,a.jsx)(em.Nt,{indicator:"line"})}),(0,a.jsx)(en.N,{type:"monotone",dataKey:"temperature",stroke:"var(--color-temperature)",strokeWidth:2,dot:!1,activeDot:{r:6}})]})})})}),(0,a.jsx)(Y.av,{value:"area",className:"h-[300px]",children:(0,a.jsx)(em.at,{config:{humidity:{label:"Humidity",color:"hsl(var(--chart-2))"}},children:(0,a.jsx)(ee.u,{width:"100%",height:"100%",children:(0,a.jsxs)(el.Q,{data:ex,children:[(0,a.jsx)(et.d,{strokeDasharray:"3 3",vertical:!1}),(0,a.jsx)(ea.W,{dataKey:"time"}),(0,a.jsx)(ei.h,{}),(0,a.jsx)(er.m,{content:(0,a.jsx)(em.Nt,{indicator:"line"})}),(0,a.jsx)(ec.G,{type:"monotone",dataKey:"humidity",stroke:"var(--color-humidity)",fill:"var(--color-humidity)",fillOpacity:.2})]})})})}),(0,a.jsx)(Y.av,{value:"bar",className:"h-[300px]",children:(0,a.jsx)(em.at,{config:{cpu:{label:"CPU Usage",color:"hsl(var(--chart-3))"}},children:(0,a.jsx)(ee.u,{width:"100%",height:"100%",children:(0,a.jsxs)(ed.E,{data:ep,children:[(0,a.jsx)(et.d,{strokeDasharray:"3 3",vertical:!1}),(0,a.jsx)(ea.W,{dataKey:"day"}),(0,a.jsx)(ei.h,{}),(0,a.jsx)(er.m,{content:(0,a.jsx)(em.Nt,{indicator:"line"})}),(0,a.jsx)(eo.y,{dataKey:"cpu",fill:"var(--color-cpu)",radius:4})]})})})}),(0,a.jsx)(Y.av,{value:"multi",className:"h-[300px]",children:(0,a.jsx)(em.at,{config:{temperature:{label:"Temperature",color:"hsl(var(--chart-1))"},humidity:{label:"Humidity",color:"hsl(var(--chart-2))"},pressure:{label:"Pressure",color:"hsl(var(--chart-3))"}},children:(0,a.jsx)(ee.u,{width:"100%",height:"100%",children:(0,a.jsxs)(es.b,{data:eh,children:[(0,a.jsx)(et.d,{strokeDasharray:"3 3",vertical:!1}),(0,a.jsx)(ea.W,{dataKey:"time"}),(0,a.jsx)(ei.h,{yAxisId:"left"}),(0,a.jsx)(ei.h,{yAxisId:"right",orientation:"right"}),(0,a.jsx)(er.m,{content:(0,a.jsx)(em.Nt,{indicator:"line"})}),(0,a.jsx)(en.N,{yAxisId:"left",type:"monotone",dataKey:"temperature",stroke:"var(--color-temperature)",strokeWidth:2,dot:!1}),(0,a.jsx)(en.N,{yAxisId:"left",type:"monotone",dataKey:"humidity",stroke:"var(--color-humidity)",strokeWidth:2,dot:!1}),(0,a.jsx)(en.N,{yAxisId:"right",type:"monotone",dataKey:"pressure",stroke:"var(--color-pressure)",strokeWidth:2,dot:!1})]})})})})]})})]})}var ev=t(14738),ej=t(79545),eg=t(14259),ey=t(53286),eb=t(94498),eN=t(40646),ew=t(37777),eS=t(53999);function eA(e){let{className:s,...t}=e;return(0,a.jsx)("div",{className:(0,eS.cn)("animate-pulse rounded-md bg-muted",s),...t})}function eI(){var e,s,t;let{toast:i}=(0,H.d)(),[n,c]=(0,r.useState)(!1),[d,o]=(0,r.useState)(!0),[m,u]=(0,r.useState)(null),[h,x]=(0,r.useState)(null),p=async()=>{c(!0),x(null);try{let e=await fetch("/api/hardware/status");if(!e.ok)throw Error("Error ".concat(e.status,": ").concat(e.statusText));let s=await e.json();u(s),d?o(!1):i({title:"Hardware status refreshed",description:"Hardware status information has been updated."})}catch(s){let e=s instanceof Error?s.message:"Failed to fetch hardware status";x(e),d||i({title:"Refresh failed",description:e,variant:"destructive"})}finally{c(!1)}};(0,r.useEffect)(()=>{p();let e=setInterval(p,3e4);return()=>clearInterval(e)},[]);let f=e=>{let{available:s,label:t,icon:i,details:r}=e;return(0,a.jsxs)(ew.m_,{children:[(0,a.jsx)(ew.k$,{asChild:!0,children:(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 rounded-lg border hover:bg-accent hover:text-accent-foreground",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)(i,{className:"h-5 w-5 ".concat(s?"text-green-500":"text-red-500")}),(0,a.jsx)("span",{children:t})]}),r?(0,a.jsx)(A.E,{variant:s?"outline":"destructive",className:"ml-2",children:r}):(0,a.jsx)("div",{className:"h-2 w-2 rounded-full ".concat(s?"bg-green-500":"bg-red-500")})]})}),(0,a.jsxs)(ew.ZI,{side:"right",className:"max-w-sm",children:[(0,a.jsx)("p",{children:s?"".concat(t," is available and working properly."):"".concat(t," is not available or not working properly.")}),r&&(0,a.jsx)("p",{className:"text-xs opacity-80 mt-1",children:r})]})]})};return d?(0,a.jsxs)(g.Zp,{children:[(0,a.jsxs)(g.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(g.ZB,{className:"text-xl font-bold",children:"Hardware Status"}),(0,a.jsx)(g.BT,{children:"Raspberry Pi hardware interfaces"})]}),(0,a.jsxs)(F.$,{variant:"outline",size:"sm",disabled:!0,children:[(0,a.jsx)(z.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Loading"]})]}),(0,a.jsx)(g.Wu,{children:(0,a.jsx)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2 lg:grid-cols-3",children:Array(6).fill(0).map((e,s)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 rounded-lg border",children:[(0,a.jsx)(eA,{className:"h-6 w-[120px]"}),(0,a.jsx)(eA,{className:"h-4 w-4 rounded-full"})]},s))})})]}):(0,a.jsxs)(g.Zp,{children:[(0,a.jsxs)(g.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(g.ZB,{className:"text-xl font-bold",children:"Hardware Status"}),(0,a.jsx)(g.BT,{children:"Raspberry Pi hardware interfaces"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)(F.$,{variant:"outline",size:"sm",onClick:()=>{p()},disabled:n,children:[(0,a.jsx)(z.A,{className:"mr-2 h-4 w-4 ".concat(n?"animate-spin":"")}),"Refresh"]}),(0,a.jsx)(F.$,{variant:"outline",size:"icon",children:(0,a.jsx)(ev.A,{className:"h-4 w-4"})})]})]}),(0,a.jsx)(g.Wu,{children:h?(0,a.jsxs)("div",{className:"flex items-center justify-center p-6 text-red-500",children:[(0,a.jsx)(ej.A,{className:"h-5 w-5 mr-2"}),(0,a.jsxs)("span",{children:["Error loading hardware status: ",h]})]}):(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-3 md:grid-cols-2 lg:grid-cols-3",children:[(0,a.jsx)(f,{available:(null==m?void 0:m.status.wifi.initialized)||!1,label:"Wi-Fi Module",icon:eg.A,details:(null==m?void 0:null===(e=m.status.wifi.status)||void 0===e?void 0:e.ipAddress)||""}),(0,a.jsx)(f,{available:(null==m?void 0:m.status.bluetooth.available)&&(null==m?void 0:m.status.bluetooth.powered)||!1,label:"Bluetooth Module",icon:b.A,details:(null==m?void 0:m.status.bluetooth.controllerName)||""}),(0,a.jsx)(f,{available:(null==m?void 0:m.status.can.initialized)||!1,label:"CAN Interface",icon:ey.A}),(0,a.jsx)(f,{available:(null==m?void 0:m.status.i2c.available)||!1,label:"I2C Buses",icon:eb.A,details:(null==m?void 0:null===(s=m.status.i2c.buses)||void 0===s?void 0:s.length)?"".concat(null==m?void 0:m.status.i2c.buses.length," bus(es)"):"None"}),(0,a.jsx)(f,{available:(null==m?void 0:m.status.spi.available)||!1,label:"SPI Interfaces",icon:l.A,details:(null==m?void 0:null===(t=m.status.spi.devices)||void 0===t?void 0:t.length)?"".concat(null==m?void 0:m.status.spi.devices.length," device(s)"):"None"}),(0,a.jsx)(f,{available:(null==m?void 0:m.status.mongodb.connected)||!1,label:"System Database",icon:eN.A}),(0,a.jsx)(f,{available:(null==m?void 0:m.status.influxdb.connected)||!1,label:"Time-Series DB",icon:eN.A}),(0,a.jsx)(f,{available:(null==m?void 0:m.status.grafana.connected)||!1,label:"Dashboard Service",icon:eN.A})]})})]})}function eD(){return(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsx)(J,{}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[(0,a.jsx)(j,{}),(0,a.jsx)(R,{}),(0,a.jsx)(W,{})]}),(0,a.jsx)(eI,{}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsx)("div",{className:"lg:col-span-2",children:(0,a.jsx)(ef,{})}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)(S,{}),(0,a.jsx)(_,{}),(0,a.jsx)(Q,{})]})]})]})}},37777:(e,s,t)=>{"use strict";t.d(s,{Bc:()=>l,ZI:()=>o,k$:()=>d,m_:()=>c});var a=t(95155),i=t(12115),r=t(35801),n=t(53999);let l=r.Kq,c=r.bL,d=r.l9,o=i.forwardRef((e,s)=>{let{className:t,sideOffset:i=4,...l}=e;return(0,a.jsx)(r.UC,{ref:s,sideOffset:i,className:(0,n.cn)("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...l})});o.displayName=r.UC.displayName},53580:(e,s,t)=>{"use strict";t.d(s,{d:()=>u});var a=t(12115);let i={ADD_TOAST:"ADD_TOAST",UPDATE_TOAST:"UPDATE_TOAST",DISMISS_TOAST:"DISMISS_TOAST",REMOVE_TOAST:"REMOVE_TOAST"},r=0,n=new Map,l=(e,s)=>{switch(s.type){case i.ADD_TOAST:return{...e,toasts:[s.toast,...e.toasts].slice(0,5)};case i.UPDATE_TOAST:return{...e,toasts:e.toasts.map(e=>e.id===s.toast.id?{...e,...s.toast}:e)};case i.DISMISS_TOAST:{let{toastId:t}=s;if(t)n.has(t)&&(clearTimeout(n.get(t)),n.delete(t));else for(let[e,s]of n.entries())clearTimeout(s),n.delete(e);return{...e,toasts:e.toasts.map(e=>e.id===t||void 0===t?{...e,open:!1}:e)}}case i.REMOVE_TOAST:if(void 0===s.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==s.toastId)}}},c=[],d={toasts:[]};function o(e){d=l(d,e),c.forEach(e=>{e(d)})}function m(e){let{...s}=e,t=(r=(r+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>o({type:i.DISMISS_TOAST,toastId:t});return o({type:i.ADD_TOAST,toast:{...s,id:t,open:!0,onOpenChange:e=>{e||a()}}}),{id:t,dismiss:a,update:e=>o({type:i.UPDATE_TOAST,toast:{...e,id:t}})}}function u(){let[e,s]=a.useState(d);return a.useEffect(()=>(c.push(s),()=>{let e=c.indexOf(s);e>-1&&c.splice(e,1)}),[e]),{...e,toast:m,dismiss:e=>o({type:i.DISMISS_TOAST,toastId:e})}}},88145:(e,s,t)=>{"use strict";t.d(s,{E:()=>l});var a=t(95155);t(12115);var i=t(74466),r=t(53999);let n=(0,i.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function l(e){let{className:s,variant:t,...i}=e;return(0,a.jsx)("div",{className:(0,r.cn)(n({variant:t}),s),...i})}}},e=>{var s=s=>e(e.s=s);e.O(0,[5393,5152,8577,7658,8507,941,5045,4363,8441,1684,7358],()=>s(10619)),_N_E=e.O()}]);