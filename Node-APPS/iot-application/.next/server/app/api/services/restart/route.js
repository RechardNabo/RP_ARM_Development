(()=>{var e={};e.id=3906,e.ids=[3906],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},8840:(e,t,s)=>{"use strict";s.r(t),s.d(t,{patchFetch:()=>w,routeModule:()=>f,serverHooks:()=>y,workAsyncStorage:()=>g,workUnitAsyncStorage:()=>h});var r={};s.r(r),s.d(r,{POST:()=>v});var a=s(96559),n=s(48088),i=s(37719),o=s(32190),u=s(79646),c=s(28354),d=s(69454);let l=(0,c.promisify)(u.exec),p=["mongodb","influxd","grafana-server","nginx","webmin"],m={mongodb:"mongodb",influxd:"influxdb","grafana-server":"grafana-server",nginx:"nginx",webmin:"webmin"};async function v(e){try{let t=[];try{let s=await e.json();t=Array.isArray(s.services)?s.services:[]}catch(e){t=[]}if(0===t.length&&(t=[...p]),t=t.filter(e=>p.includes(e)),"true"===process.env.NEXT_PUBLIC_V0_PREVIEW){let e=(0,d.e)(),s=[];for(let r of t){let t=await e.restartService(r);s.push({service:r,success:t,message:t?`${r} restarted successfully`:`Failed to restart ${r}`})}return o.NextResponse.json({success:!0,message:"Services restarted",results:s})}let s=[];for(let e of t)try{let t=m[e]||e;await l(`sudo systemctl restart ${t}`),s.push({service:e,success:!0,message:`${e} restarted successfully`})}catch(t){console.error(`Error restarting ${e}:`,t),s.push({service:e,success:!1,message:`Failed to restart ${e}: ${t instanceof Error?t.message:"Unknown error"}`})}let r=s.every(e=>e.success);return o.NextResponse.json({success:r,message:r?"All services restarted successfully":"Some services failed to restart",results:s},{status:r?200:207})}catch(e){return console.error("Error restarting services:",e),o.NextResponse.json({success:!1,message:"Failed to restart services",error:e instanceof Error?e.message:"Unknown error"},{status:500})}}let f=new a.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/services/restart/route",pathname:"/api/services/restart",filename:"route",bundlePath:"app/api/services/restart/route"},resolvedPagePath:"C:\\Users\\Mtlantla\\Desktop\\EmberCore\\Dev_RP3_c\\Node-APPS\\iot-application\\app\\api\\services\\restart\\route.ts",nextConfigOutput:"",userland:r}),{workAsyncStorage:g,workUnitAsyncStorage:h,serverHooks:y}=f;function w(){return(0,i.patchFetch)({workAsyncStorage:g,workUnitAsyncStorage:h})}},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},28354:e=>{"use strict";e.exports=require("util")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},69454:(e,t,s)=>{"use strict";s.d(t,{e:()=>n});class r{constructor(){this.services=[],this.interfaces=[],this.updateInterval=null,this.services=[{name:"mongodb",status:"running",pid:1234,memory:256.5,cpu:2.3,uptime:86400,port:27017,lastUpdated:Date.now()},{name:"influxd",status:"running",pid:1235,memory:128.7,cpu:1.5,uptime:172800,port:8086,lastUpdated:Date.now()},{name:"grafana-server",status:"running",pid:1236,memory:98.2,cpu:.8,uptime:86400,port:3e3,lastUpdated:Date.now()},{name:"webmin",status:"running",pid:1237,memory:45.6,cpu:.2,uptime:259200,port:1e4,lastUpdated:Date.now()},{name:"nginx",status:"running",pid:1238,memory:32.1,cpu:.3,uptime:172800,port:80,lastUpdated:Date.now()}],this.interfaces=[{name:"SPI0",type:"spi",status:"active",details:{speed:"10 MHz",mode:0,devices:2},lastUpdated:Date.now()},{name:"I2C1",type:"i2c",status:"active",details:{speed:"400 kHz",devices:4},lastUpdated:Date.now()},{name:"CAN0",type:"can",status:"inactive",details:{bitrate:"500 kbit/s"},lastUpdated:Date.now()},{name:"UART0",type:"uart",status:"active",details:{baudrate:"115200",parity:"none",databits:8,stopbits:1},lastUpdated:Date.now()},{name:"GPIO",type:"gpio",status:"active",details:{pins:40,used:8},lastUpdated:Date.now()}]}startMonitoring(e=5e3){this.updateInterval&&clearInterval(this.updateInterval),this.updateInterval=setInterval(()=>{this.updateServiceStatus(),this.updateInterfaceStatus()},e),console.log(`Service monitoring started with interval of ${e}ms`)}stopMonitoring(){this.updateInterval&&(clearInterval(this.updateInterval),this.updateInterval=null,console.log("Service monitoring stopped"))}getServiceStatus(e){return e?this.services.find(t=>t.name===e)||{name:e,status:"unknown",lastUpdated:Date.now()}:[...this.services]}getInterfaceStatus(e){return e?this.interfaces.find(t=>t.name===e)||{name:e,type:"gpio",status:"error",lastUpdated:Date.now()}:[...this.interfaces]}async restartService(e){return new Promise(t=>{let s=this.services.find(t=>t.name===e);if(!s){console.log(`Service ${e} not found`),t(!1);return}console.log(`Restarting service ${e}...`),s.status="stopped",setTimeout(()=>{s.status="running",s.uptime=0,s.lastUpdated=Date.now(),console.log(`Service ${e} restarted successfully`),t(!0)},2e3)})}async enableInterface(e){return new Promise(t=>{let s=this.interfaces.find(t=>t.name===e);if(!s){console.log(`Interface ${e} not found`),t(!1);return}console.log(`Enabling interface ${e}...`),setTimeout(()=>{s.status="active",s.lastUpdated=Date.now(),console.log(`Interface ${e} enabled successfully`),t(!0)},1e3)})}async disableInterface(e){return new Promise(t=>{let s=this.interfaces.find(t=>t.name===e);if(!s){console.log(`Interface ${e} not found`),t(!1);return}console.log(`Disabling interface ${e}...`),setTimeout(()=>{s.status="inactive",s.lastUpdated=Date.now(),console.log(`Interface ${e} disabled successfully`),t(!0)},1e3)})}updateServiceStatus(e=!1){this.services.forEach(e=>{e.cpu=Math.max(.1,Math.min(100,e.cpu+(2*Math.random()-1))),e.memory=Math.max(10,Math.min(1024,e.memory+(10*Math.random()-5))),e.uptime+=5,Math.random()>.98&&(e.status="running"===e.status?"error":"running"),e.lastUpdated=Date.now()})}updateInterfaceStatus(e=!1){this.interfaces.forEach(e=>{Math.random()>.95&&(e.status="active"===e.status?"inactive":"active"),"i2c"===e.type&&e.details?e.details.devices=Math.floor(6*Math.random())+1:"spi"===e.type&&e.details&&(e.details.devices=Math.floor(3*Math.random())+1),e.lastUpdated=Date.now()})}}let a=null;function n(){return a||(a=new r).startMonitoring(),a}},78335:()=>{},79646:e=>{"use strict";e.exports=require("child_process")},96487:()=>{}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[7719,580],()=>s(8840));module.exports=r})();