"use strict";(()=>{var e={};e.id=1821,e.ids=[1821],e.modules={3295:e=>{e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9921:(e,t,r)=>{r.r(t),r.d(t,{patchFetch:()=>w,routeModule:()=>m,serverHooks:()=>g,workAsyncStorage:()=>f,workUnitAsyncStorage:()=>v});var s={};r.r(s),r.d(s,{POST:()=>h});var a=r(96559),n=r(48088),i=r(37719),o=r(32190),u=r(79646),d=r(28354),p=r(99999),c=r(69454);let l=(0,d.promisify)(u.exec);async function h(e){try{if("true"===process.env.NEXT_PUBLIC_V0_PREVIEW)return o.NextResponse.json({success:!0,message:"All dashboard data refreshed successfully",refreshed:["hardware","services","network","devices"]});let e=[];try{let t=(0,p.G)();t.isInitialized()||await t.initialize(),await t.getStatus(!0),e.push("hardware")}catch(e){console.error("Error refreshing hardware status:",e)}try{let t=(0,c.e)();t.updateServiceStatus(!0),t.updateInterfaceStatus(!0),e.push("services")}catch(e){console.error("Error refreshing service status:",e)}try{e.push("devices")}catch(e){console.error("Error refreshing device counts:",e)}try{await l("ip link set dev eth0 down && ip link set dev eth0 up 2>/dev/null || true"),await l("ip link set dev wlan0 down && ip link set dev wlan0 up 2>/dev/null || true"),e.push("network")}catch(e){console.error("Error refreshing network interfaces:",e)}return o.NextResponse.json({success:!0,message:"Dashboard data refreshed successfully",refreshed:e})}catch(e){return console.error("Error refreshing dashboard data:",e),o.NextResponse.json({success:!1,message:"Failed to refresh dashboard data",error:e instanceof Error?e.message:"Unknown error"},{status:500})}}let m=new a.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/system/refresh/route",pathname:"/api/system/refresh",filename:"route",bundlePath:"app/api/system/refresh/route"},resolvedPagePath:"C:\\Users\\Mtlantla\\Desktop\\EmberCore\\Dev_RP3_c\\Node-APPS\\iot-application\\app\\api\\system\\refresh\\route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:f,workUnitAsyncStorage:v,serverHooks:g}=m;function w(){return(0,i.patchFetch)({workAsyncStorage:f,workUnitAsyncStorage:v})}},10846:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12412:e=>{e.exports=require("assert")},12518:e=>{e.exports=require("mongodb")},27910:e=>{e.exports=require("stream")},28354:e=>{e.exports=require("util")},29021:e=>{e.exports=require("fs")},29294:e=>{e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{e.exports=require("path")},44870:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},55511:e=>{e.exports=require("crypto")},55591:e=>{e.exports=require("https")},63033:e=>{e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},69454:(e,t,r)=>{r.d(t,{e:()=>n});class s{constructor(){this.services=[],this.interfaces=[],this.updateInterval=null,this.services=[{name:"mongodb",status:"running",pid:1234,memory:256.5,cpu:2.3,uptime:86400,port:27017,lastUpdated:Date.now()},{name:"influxd",status:"running",pid:1235,memory:128.7,cpu:1.5,uptime:172800,port:8086,lastUpdated:Date.now()},{name:"grafana-server",status:"running",pid:1236,memory:98.2,cpu:.8,uptime:86400,port:3e3,lastUpdated:Date.now()},{name:"webmin",status:"running",pid:1237,memory:45.6,cpu:.2,uptime:259200,port:1e4,lastUpdated:Date.now()},{name:"nginx",status:"running",pid:1238,memory:32.1,cpu:.3,uptime:172800,port:80,lastUpdated:Date.now()}],this.interfaces=[{name:"SPI0",type:"spi",status:"active",details:{speed:"10 MHz",mode:0,devices:2},lastUpdated:Date.now()},{name:"I2C1",type:"i2c",status:"active",details:{speed:"400 kHz",devices:4},lastUpdated:Date.now()},{name:"CAN0",type:"can",status:"inactive",details:{bitrate:"500 kbit/s"},lastUpdated:Date.now()},{name:"UART0",type:"uart",status:"active",details:{baudrate:"115200",parity:"none",databits:8,stopbits:1},lastUpdated:Date.now()},{name:"GPIO",type:"gpio",status:"active",details:{pins:40,used:8},lastUpdated:Date.now()}]}startMonitoring(e=5e3){this.updateInterval&&clearInterval(this.updateInterval),this.updateInterval=setInterval(()=>{this.updateServiceStatus(),this.updateInterfaceStatus()},e),console.log(`Service monitoring started with interval of ${e}ms`)}stopMonitoring(){this.updateInterval&&(clearInterval(this.updateInterval),this.updateInterval=null,console.log("Service monitoring stopped"))}getServiceStatus(e){return e?this.services.find(t=>t.name===e)||{name:e,status:"unknown",lastUpdated:Date.now()}:[...this.services]}getInterfaceStatus(e){return e?this.interfaces.find(t=>t.name===e)||{name:e,type:"gpio",status:"error",lastUpdated:Date.now()}:[...this.interfaces]}async restartService(e){return new Promise(t=>{let r=this.services.find(t=>t.name===e);if(!r){console.log(`Service ${e} not found`),t(!1);return}console.log(`Restarting service ${e}...`),r.status="stopped",setTimeout(()=>{r.status="running",r.uptime=0,r.lastUpdated=Date.now(),console.log(`Service ${e} restarted successfully`),t(!0)},2e3)})}async enableInterface(e){return new Promise(t=>{let r=this.interfaces.find(t=>t.name===e);if(!r){console.log(`Interface ${e} not found`),t(!1);return}console.log(`Enabling interface ${e}...`),setTimeout(()=>{r.status="active",r.lastUpdated=Date.now(),console.log(`Interface ${e} enabled successfully`),t(!0)},1e3)})}async disableInterface(e){return new Promise(t=>{let r=this.interfaces.find(t=>t.name===e);if(!r){console.log(`Interface ${e} not found`),t(!1);return}console.log(`Disabling interface ${e}...`),setTimeout(()=>{r.status="inactive",r.lastUpdated=Date.now(),console.log(`Interface ${e} disabled successfully`),t(!0)},1e3)})}updateServiceStatus(e=!1){this.services.forEach(e=>{e.cpu=Math.max(.1,Math.min(100,e.cpu+(2*Math.random()-1))),e.memory=Math.max(10,Math.min(1024,e.memory+(10*Math.random()-5))),e.uptime+=5,Math.random()>.98&&(e.status="running"===e.status?"error":"running"),e.lastUpdated=Date.now()})}updateInterfaceStatus(e=!1){this.interfaces.forEach(e=>{Math.random()>.95&&(e.status="active"===e.status?"inactive":"active"),"i2c"===e.type&&e.details?e.details.devices=Math.floor(6*Math.random())+1:"spi"===e.type&&e.details&&(e.details.devices=Math.floor(3*Math.random())+1),e.lastUpdated=Date.now()})}}let a=null;function n(){return a||(a=new s).startMonitoring(),a}},74075:e=>{e.exports=require("zlib")},79428:e=>{e.exports=require("buffer")},79551:e=>{e.exports=require("url")},79646:e=>{e.exports=require("child_process")},81630:e=>{e.exports=require("http")},83997:e=>{e.exports=require("tty")},94735:e=>{e.exports=require("events")}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[7719,580,2326,4507],()=>r(9921));module.exports=s})();